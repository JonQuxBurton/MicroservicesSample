version: '3.4'

services:
  sql.data:
      environment:
        - SA_PASSWORD=Pass@word
        - ACCEPT_EULA=Y
      ports:
        - "5433:1433"    # Important: In a production environment your should remove the external port
 
  customers:
    environment:
      #- ASPNETCORE_ENVIRONMENT=Development
      - ConnectionString=Server=sql.data,1433;Initial Catalog=Microservices;User Id=sa;Password=Pass@word
      #- ConnectionString=${CUSTOMERS_DB:-Server=sql.da3ta;Initial Catalog=Microservices;User Id=sa;Password=Pass@word}
      - EventStoreUrl=tcp://admin:changeit@eventstore:1113
    ports:
      - "5001:80"

  eventstore:
    ports:
      - "1113:1113"
      - "2113:2113"

  phonelineorderer:
    environment:
      #- ASPNETCORE_ENVIRONMENT=Development
      - ConnectionString=Server=sql.data,1433;Initial Catalog=Microservices;User Id=sa;Password=Pass@word
      - CustomersWebServiceUrl=customers
    ports:
      - "5002:80"
 
  phonelineorderer.ordersplacedsubscriber:
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionString=Server=sql.data,1433;Initial Catalog=Microservices;User Id=sa;Password=Pass@word
      - CustomersWebServiceUrl=http://customers

 # fakebt:
 #   environment:
 #     - ASPNETCORE_ENVIRONMENT=Development
 #   ports:
 #     - "5003:80"
